<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.4">
<meta name="author" content="Pieter Martin">
<title>Sqlg Documentation</title>
<link rel="stylesheet" href="./asciidoctor-default.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Sqlg Documentation</h1>
<div class="details">
<span id="author" class="author">Pieter Martin</span><br>
<span id="revnumber">version 1.3.3,</span>
<span id="revdate">December 2016</span>
<br><span id="revremark"></span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">Introduction</a></li>
<li><a href="#_tinkerpop_supported_features">TinkerPop supported features</a></li>
<li><a href="#_getting_started">Getting Started</a>
<ul class="sectlevel2">
<li><a href="#_maven_coordinates">Maven coordinates</a></li>
<li><a href="#_running">Running</a></li>
<li><a href="#_tests">Tests</a></li>
<li><a href="#_gremlin_console">Gremlin Console</a></li>
</ul>
</li>
<li><a href="#_data_types">Data types</a></li>
<li><a href="#_architecture">Architecture</a>
<ul class="sectlevel2">
<li><a href="#_vertex_tables">Vertex tables</a></li>
<li><a href="#_edge_tables">Edge tables</a></li>
<li><a href="#_tinkerpop_modern">TinkerPop-modern</a></li>
<li><a href="#_namespacing_and_schemas">Namespacing and Schemas</a></li>
</ul>
</li>
<li><a href="#_indexes">Indexes</a>
<ul class="sectlevel2">
<li><a href="#_basic_indexing">Basic indexing</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><em><a href="https://github.com/pietermartin/sqlg"><strong>Sqlg</strong></a></em> is a implementation of <em><a href="http://tinkerpop.apache.org/">Apache TinkerPop</a></em> on a <em><a href="http://en.wikipedia.org/wiki/Relational_database_management_system">RDBMS</a></em>.
Currently <em><a href="http://www.postgresql.org/">Postgresql</a></em>, <em><a href="http://hsqldb.org/">HSQLDB</a></em>, and <em><a href="http://h2database.com">H2 database</a></em> are supported.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Sqlg primary challenge is to reduce latency by combining TinkerPop <em><a href="http://tinkerpop.apache.org/docs/current/reference/#graph-traversal-steps">steps</a></em>
into as few as possible database calls. The fine grained nature of graph traversals makes this crucial else the remote
call latency has a severe performance impact.</p>
</div>
<div class="paragraph">
<p>Additionally for Postgresql Sqlg supports various bulk modes to reduce latency when modifying the graph.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Hsqldb and H2 do not suffer the same latency as Postgresql as it runs embedded in the jvm.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tinkerpop_supported_features">TinkerPop supported features</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Sqlg version 1.3.3 runs on TinkerPop 3.2.3</p>
</div>
<div class="paragraph">
<p>Sqlg passes TinkerPop&#8217;s <code>StructureStandardSuite</code> and <code>ProcessStandardSuite</code> test suites.</p>
</div>
<div class="ulist">
<div class="title">Graph Features <strong>not</strong> implemented.</div>
<ul>
<li>
<p>Computer</p>
</li>
<li>
<p>ThreadedTransactions</p>
</li>
<li>
<p>Variables</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Vertex Features <strong>not</strong> implemented.</div>
<ul>
<li>
<p>MultiProperties</p>
</li>
<li>
<p>MetaProperties</p>
</li>
<li>
<p>UserSuppliedIds</p>
</li>
<li>
<p>NumericIds</p>
</li>
<li>
<p>StringIds</p>
</li>
<li>
<p>UuidIds</p>
</li>
<li>
<p>CustomIds</p>
</li>
<li>
<p>AnyIds</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Edge Features <strong>not</strong> implemented.</div>
<ul>
<li>
<p>UserSuppliedIds</p>
</li>
<li>
<p>NumericIds</p>
</li>
<li>
<p>StringIds</p>
</li>
<li>
<p>UuidIds</p>
</li>
<li>
<p>CustomIds</p>
</li>
<li>
<p>AnyIds</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Vertex property features <strong>not</strong> implemented.</div>
<ul>
<li>
<p>AddProperty</p>
</li>
<li>
<p>RemoveProperty</p>
</li>
<li>
<p>UserSuppliedIds</p>
</li>
<li>
<p>NumericIds</p>
</li>
<li>
<p>StringIds</p>
</li>
<li>
<p>UuidIds</p>
</li>
<li>
<p>CustomIds</p>
</li>
<li>
<p>AnyIds</p>
</li>
<li>
<p>MapValues</p>
</li>
<li>
<p>MixedListValues</p>
</li>
<li>
<p>SerializableValues</p>
</li>
<li>
<p>UniformListValues</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Edge property feature <strong>not</strong> implemented.</div>
<ul>
<li>
<p>MapValues</p>
</li>
<li>
<p>MixedListValues</p>
</li>
<li>
<p>SerializableValues</p>
</li>
<li>
<p>UniformListValues</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_started">Getting Started</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_maven_coordinates">Maven coordinates</h3>
<div class="literalblock">
<div class="title">Postgresql</div>
<div class="content">
<pre>&lt;dependency&gt;
    &lt;groupId&gt;org.umlg&lt;/groupId&gt;
    &lt;artifactId&gt;sqlg-postgres&lt;/artifactId&gt;
    &lt;version&gt;1.3.3&lt;/version&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
<div class="literalblock">
<div class="title">HSQLDB</div>
<div class="content">
<pre>&lt;dependency&gt;
    &lt;groupId&gt;org.umlg&lt;/groupId&gt;
    &lt;artifactId&gt;sqlg-hsqldb&lt;/artifactId&gt;
    &lt;version&gt;1.3.3&lt;/version&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
<div class="literalblock">
<div class="title">H2</div>
<div class="content">
<pre>&lt;dependency&gt;
    &lt;groupId&gt;org.umlg&lt;/groupId&gt;
    &lt;artifactId&gt;sqlg-h2&lt;/artifactId&gt;
    &lt;version&gt;1.3.3&lt;/version&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>This will include <code>gremlin-groovy</code>. If you have no need for that then use the following coordinates.</p>
</div>
<div class="literalblock">
<div class="title">Postgresql</div>
<div class="content">
<pre>&lt;dependency&gt;
    &lt;groupId&gt;org.umlg&lt;/groupId&gt;
    &lt;artifactId&gt;sqlg-postgres-dialect&lt;/artifactId&gt;
    &lt;version&gt;1.3.3&lt;/version&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
<div class="literalblock">
<div class="title">HSQLDB</div>
<div class="content">
<pre>&lt;dependency&gt;
    &lt;groupId&gt;org.umlg&lt;/groupId&gt;
    &lt;artifactId&gt;sqlg-hsqldb-dialect&lt;/artifactId&gt;
    &lt;version&gt;1.3.3&lt;/version&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
<div class="literalblock">
<div class="title">H2</div>
<div class="content">
<pre>&lt;dependency&gt;
    &lt;groupId&gt;org.umlg&lt;/groupId&gt;
    &lt;artifactId&gt;sqlg-h2-dialect&lt;/artifactId&gt;
    &lt;version&gt;1.3.3&lt;/version&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_running">Running</h3>
<div class="paragraph">
<p>Sqlg runs as a singleton that can be shared among multiple threads. You instantiate Sqlg using the standard
TinkerPop static constructors.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>SqlgGraph.open(final Configuration configuration)</code></p>
</li>
<li>
<p><code>SqlgGraph.open(final String pathToSqlgProperties)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The configuration object requires the following properties.</p>
</div>
<div class="literalblock">
<div class="title">Postgresql</div>
<div class="content">
<pre>jdbc.url=jdbc:postgresql://localhost:5432/yourdb
jdbc.username=postgres
jdbc.password=******</pre>
</div>
</div>
<div class="literalblock">
<div class="title">HSQLDB</div>
<div class="content">
<pre>jdbc.url=jdbc:hsqldb:file:/tmp/yourdb
jdbc.username=SA
jdbc.password=</pre>
</div>
</div>
<div class="literalblock">
<div class="title">H2</div>
<div class="content">
<pre>jdbc.url=jdbc:h2:file:target/tmp/yourdb
jdbc.username=SA
jdbc.password=</pre>
</div>
</div>
<div class="paragraph">
<p>In the case of Postgresql the database must already exist.</p>
</div>
</div>
<div class="sect2">
<h3 id="_tests">Tests</h3>
<div class="paragraph">
<p>If you want to run the TinkerPop tests on Postgresql you need to create the various databases that are used.</p>
</div>
<div class="literalblock">
<div class="title">These are,</div>
<div class="content">
<pre>g1
g2
readGraph
standard
temp
temp1
temp2
subgraph
prototype
target</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_gremlin_console">Gremlin Console</h3>
<div class="literalblock">
<div class="title">Postgresql</div>
<div class="content">
<pre>[pieter@pieter-laptop bin]$ ./gremlin.sh
         \,,,/
         (o o)
-----oOOo-(3)-oOOo-----
plugin activated: tinkerpop.server
plugin activated: tinkerpop.utilities
plugin activated: tinkerpop.tinkergraph
gremlin&gt; :install org.umlg sqlg-postgres 1.3.3
log4j:WARN No appenders could be found for logger (org.apache.tinkerpop.gremlin.groovy.util.DependencyGrabber).
log4j:WARN Please initialize the log4j system properly.
log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.
==&gt;Loaded: [org.umlg, sqlg-postgres, 1.3.3]
gremlin&gt; :plugin list
==&gt;tinkerpop.server[active]
==&gt;tinkerpop.gephi
==&gt;tinkerpop.utilities[active]
==&gt;tinkerpop.sugar
==&gt;tinkerpop.credentials
==&gt;tinkerpop.tinkergraph[active]
==&gt;sqlg.postgres
gremlin&gt; :plugin use sqlg.postgres
==&gt;sqlg.postgres activated
gremlin&gt; graph = SqlgGraph.open('pathTo/sqlg.properties')
==&gt;sqlggraph[SqlGraph]
gremlin&gt; g = graph.traversal()
==&gt;sqlggraphtraversalsource[sqlggraph[SqlGraph] (jdbc:postgresql://localhost:5432/sqlgraphdb), standard]
gremlin&gt; graph.io(graphml()).readGraph('pathTo/grateful-dead.xml')
==&gt;null
gremlin&gt; g.V().count()
==&gt;808
gremlin&gt;</pre>
</div>
</div>
<div class="literalblock">
<div class="title">HSQLDB</div>
<div class="content">
<pre>[pieter@pieter-laptop bin]$ ./gremlin.sh</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>         \,,,/
         (o o)
-----oOOo-(3)-oOOo-----
plugin activated: tinkerpop.server
plugin activated: tinkerpop.utilities
plugin activated: tinkerpop.tinkergraph
gremlin&gt; :install org.umlg sqlg-hsqldb 1.3.3
log4j:WARN No appenders could be found for logger (org.apache.tinkerpop.gremlin.groovy.util.DependencyGrabber).
log4j:WARN Please initialize the log4j system properly.
log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.
==&gt;Loaded: [org.umlg, sqlg-hsqldb, 1.3.3]
gremlin&gt; :plugin list
==&gt;tinkerpop.server[active]
==&gt;tinkerpop.gephi
==&gt;tinkerpop.utilities[active]
==&gt;tinkerpop.sugar
==&gt;tinkerpop.credentials
==&gt;tinkerpop.tinkergraph[active]
==&gt;sqlg.hsqldb
gremlin&gt; :plugin use sqlg.hsqldb
==&gt;sqlg.hsqldb activated
gremlin&gt; graph = SqlgGraph.open('pathTo/sqlg.properties')
==&gt;sqlggraph[SqlGraph]
gremlin&gt; g = graph.traversal()
==&gt;sqlggraphtraversalsource[sqlggraph[SqlGraph] (jdbc:hsqldb:file:src/test/db/sqlgraphdb), standard]
gremlin&gt; graph.io(graphml()).readGraph('pathTo/grateful-dead.xml')
==&gt;null
gremlin&gt; g.V().count()
==&gt;808
gremlin&gt;</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_data_types">Data types</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Table Data types</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Java</th>
<th class="tableblock halign-left valign-top">Postgresql</th>
<th class="tableblock halign-left valign-top">HSQLDB</th>
<th class="tableblock halign-left valign-top">H2</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BOOLEAN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BOOLEAN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BOOLEAN</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Byte</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Not supported</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TINYINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TINYINT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Short</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SMALLINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SMALLINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SMALLINT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INTEGER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INTEGER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BIGINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BIGINT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BIGINT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Float</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Not supported</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REAL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DOUBLE PRECISION</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DOUBLE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DOUBLE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TEXT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LONGVARCHAR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VARCHAR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BOOLEAN[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BOOLEAN ARRAY DEFAULT ARRAY[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ARRAY</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Byte[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BYTEA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LONGVARBINARY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BINARY</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Short[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SMALLINT[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SMALLINT ARRAY DEFAULT ARRAY[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ARRAY</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INTEGER[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INTEGER ARRAY DEFAULT ARRAY[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ARRAY</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BIGINT[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BIGINT ARRAY DEFAULT ARRAY[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ARRAY</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Float[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REAL[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Not supported</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ARRAY</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Double[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DOUBLE PRECISION[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DOUBLE ARRAY DEFAULT ARRAY[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ARRAY</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TEXT[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LONGVARCHAR ARRAY DEFAULT ARRAY[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ARRAY</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.time.LocalDateTime</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TIMESTAMP WITH TIME ZONE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TIMESTAMP WITH TIME ZONE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TIMESTAMP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.time.LocalDate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DATE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DATE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DATE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.time.LocalTime</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TIME WITH TIME ZONE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TIME WITH TIME ZONE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TIME</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.time.ZonedDateTime</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TIMESTAMP WITH TIME ZONE, TEXT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TIMESTAMP WITH TIME ZONE, LONGVARCHAR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TIMESTAMP, VARCHAR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.time.Period</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INTEGER, INTEGER, INTEGER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INTEGER, INTEGER, INTEGER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INT, INT, INT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.time.Duration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BIGINT, INTEGER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BIGINT, INTEGER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BIGINT, INT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.time.LocalDateTime[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TIMESTAMP WITH TIME ZONE[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TIMESTAMP WITH TIME ZONE ARRAY DEFAULT ARRAY[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ARRAY</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.time.LocalDate[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DATE[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DATE ARRAY DEFAULT ARRAY[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ARRAY</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.time.LocalTime[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TIME WITH TIME ZONE ARRAY DEFAULT ARRAY[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TIME WITH TIME ZONE[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ARRAY</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.time.ZonedDateTime[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TIMESTAMP WITH TIME ZONE[], TEXT[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TIMESTAMP WITH TIME ZONE ARRAY DEFAULT ARRAY[], LONGVARCHAR ARRAY DEFAULT ARRAY[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ARRAY</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.time.Period[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INTEGER[], INTEGER[], INTEGER[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INTEGER ARRAY DEFAULT ARRAY[], INTEGER ARRAY DEFAULT ARRAY[], INTEGER ARRAY DEFAULT ARRAY[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ARRAY</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">java.time.Duration[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BIGINT[], INTEGER[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BIGINT ARRAY DEFAULT ARRAY[], INTEGER ARRAY DEFAULT ARRAY[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ARRAY</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">com.fasterxml.jackson.databind.JsonNode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSONB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Not supported</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Not supported</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">com.fasterxml.jackson.databind.JsonNode[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSONB[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Not supported</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Not supported</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.postgis.Point</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">geometry(POINT)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Not supported</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Not supported</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.umlg.sqlg.gis.GeographyPoint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">geography(POINT, 4326)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Not supported</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Not supported</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.postgis.LineString</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">geometry(LINESTRING)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Not supported</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Not supported</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.postgis.Polygon</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">geometry(POLYGON)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Not supported</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Not supported</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.umlg.sqlg.gis.GeographyPolygon</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">geography(POLYGON, 4326)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Not supported</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Not supported</strong></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<code>java.time.LocalTime</code> drops the nano second precision.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_architecture">Architecture</h2>
<div class="sectionbody">
<div class="paragraph">
<p>With the coming of vertex labels to TinkerPop the mapping of TinkerPop&#8217;s graph semantics to that of a RDBMS became natural and useful.</p>
</div>
<div class="sect2">
<h3 id="_vertex_tables">Vertex tables</h3>
<div class="paragraph">
<p>Every unique vertex label maps to a table. Vertex tables are prefixed with a <code>V_</code>. i.e. <code>V_Person</code>. The vertex table
stores the vertex&#8217;s properties.</p>
</div>
</div>
<div class="sect2">
<h3 id="_edge_tables">Edge tables</h3>
<div class="paragraph">
<p>Every unique edge label maps to a table. Edge tables are prefixed with a <code>E_</code>. i.e. <code>E_friend</code>. The edge table stores
each edge&#8217;s adjacent vertex ids and the edge properties. The column corresponding to each adjacent vertex id (<code>IN</code> and <code>OUT</code>)
has a foreign key to the adjacent vertex&#8217;s table. The foreign key is optional, instead just an index on the adjacent vertex id
can be used.</p>
</div>
<div class="paragraph">
<p>From a rdbms' perspective each edge table is the classic <code>many to many</code> join table between vertices.</p>
</div>
</div>
<div class="sect2">
<h3 id="_tinkerpop_modern">TinkerPop-modern</h3>
<div class="paragraph">
<p>Taken from <em><a href="http://tinkerpop.apache.org/docs/current/reference/#intro">TinkerPop</a></em></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="src/main/images/sqlg/tinkerpop-modern-graph.png" alt="image of tinkerpop-classic"></span></p>
</div>
<div class="sect3">
<h4 id="_er_diagram">ER Diagram</h4>
<div class="paragraph">
<p><span class="image"><img src="src/main/images/sqlg/tinkerpop-modern-er.png" alt="image of tinkerpop-classic"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_v_person">V_person</h4>
<div class="paragraph">
<p><span class="image"><img src="src/main/images/sqlg/V_person.png" alt="image of tinkerpop-classic"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_v_software">V_software</h4>
<div class="paragraph">
<p><span class="image"><img src="src/main/images/sqlg/V_software.png" alt="image of tinkerpop-classic"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_e_knows">E_knows</h4>
<div class="paragraph">
<p><span class="image"><img src="src/main/images/sqlg/E_knows.png" alt="image of tinkerpop-classic"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_e_created">E_created</h4>
<div class="paragraph">
<p><span class="image"><img src="src/main/images/sqlg/E_created.png" alt="image of tinkerpop-classic"></span></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_namespacing_and_schemas">Namespacing and Schemas</h3>
<div class="paragraph">
<p>Many RDBMS databases have the notion of a <code>schema</code> as a namespace for tables. Sqlg supports schemas
for vertex labels. Distinct schemas for edge tables are unnecessary as edge tables are created in the schema of the adjacent <code>out</code> vertex.
By default schemas for vertex tables go into the underlying databases' default schema. For Postgresql, hsqldb and H2 this
is the <code>public</code> schema.</p>
</div>
<div class="paragraph">
<p>To specify the schema for a label Sqlg uses the dot <code>.</code> notation.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Vertex john = this.sqlgGraph.addVertex(T.label, "manager", "name", "john");
Vertex palace1 = this.sqlgGraph.addVertex(T.label, "continent.house", "name", "palace1");
Vertex corrola = this.sqlgGraph.addVertex(T.label, "fleet.car", "model", "corrola");
palace1.addEdge("managedBy", john);
corrola.addEdge("owner", john);</pre>
</div>
</div>
<div class="paragraph">
<p>This will create a table <code>V_manager</code> in the <code>public</code> (default) schema. Table <code>V_house</code> is in the <code>continent</code> schema and table <code>V_car</code>
is in the <code>fleet</code> schema.
For the <code>managedBy</code> edge a <code>E_managedBy</code> table is created in the <code>continent</code> schema as its <code>out</code> vertex <code>palace1</code> is in the <code>continent</code> schema and
for the <code>owner</code> edge a <code>E_owner</code> table is created in the <code>fleet</code> schema as its <code>out</code> vertex is in the `fleet`schema.</p>
</div>
<div class="sect3">
<h4 id="_schemas">Schemas</h4>
<div class="paragraph">
<p><span class="image"><img src="src/main/images/sqlg/schemas.png" alt="image of tinkerpop-classic"></span>
<span class="image"><img src="src/main/images/sqlg/continent.png" alt="image of tinkerpop-classic"></span>
<span class="image"><img src="src/main/images/sqlg/fleet.png" alt="image of tinkerpop-classic"></span>
<span class="image"><img src="src/main/images/sqlg/public.png" alt="image of tinkerpop-classic"></span></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_indexes">Indexes</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_basic_indexing">Basic indexing</h3>
<div class="paragraph">
<p>Sqlg supports adding a unique or non-unique index to any property.</p>
</div>
<div class="paragraph">
<p>To add an index one has to use Sqlg&#8217;s topology interface.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>this.sqlgGraph.addVertex(T.label, "Person", "name", "john");
Optional&lt;VertexLabel&gt; personVertexOptional = this.sqlgGraph.getTopology().getVertexLabel(this.sqlgGraph.getSqlDialect().getPublicSchema(), "Person");
Preconditions.checkState(personVertexOptional.isPresent());
Optional&lt;PropertyColumn&gt; namePropertyOptional = personVertexOptional.get().getProperty("name");
Preconditions.checkState(namePropertyOptional.isPresent());
//Create the index
Index index = personVertexOptional.get().ensureIndexExists(IndexType.NON_UNIQUE, Collections.singletonList(namePropertyOptional.get()));</pre>
</div>
</div>
<div class="paragraph">
<p>Outside of creating the index Sqlg has no further direct interaction with the index. However gremlin queries with a
<code>has</code> step will translate to a sql <code>where</code> clause. If an index has been created on the property of the <code>has</code> step then
the underlying RDBMS will utilize that index on that property&#8217;s column.</p>
</div>
<div class="paragraph">
<p>The index does not need to be created upfront. It can be added any time.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 1.3.3<br>
Last updated 2016-12-23 20:50:21 +02:00
</div>
</div>
</body>
</html>